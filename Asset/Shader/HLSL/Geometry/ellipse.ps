#include "ellipse.h"

bool valid_range_circle(VertexAttr_Ellipse input) 
{
    return valid_range(input.radius, input.uv, input.range);
}

float circle_distance(VertexAttr_Ellipse input) 
{
    return abs(sqrt(input.uv.x*input.uv.x + input.uv.y*input.uv.y) - input.radius.x);
}

float4 Ellipse_Dash_PS(VertexAttr_Ellipse input) : SV_TARGET 
{
    if (!valid_range_circle(input))
        discard;

    float width = ((uint)input.weight & 0x1) != 0 ? input.weight : input.weight + 1.0f;
	float dist = circle_distance(input);

    return compute_final_color(dist, width, input.color);
}